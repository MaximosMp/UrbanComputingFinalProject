2024-01-03 11:57:12: Experiment log path in: C:\Users\30697\Desktop\UrbanComputingFinalProject\UrbanComputingFinalProject\ST-SSL\experiments\NYCBike1\20240103-115712
2024-01-03 11:57:12: Experiment configs are: Namespace(batch_size=32, best_path='None', d_input=2, d_model=64, d_output=2, data_dir='data', dataset='NYCBike1', debug=False, device='cpu', dropout=0.2, early_stop=True, early_stop_patience=15, epochs=100, grad_norm=True, graph_file='data/NYCBike1/adj_mx.npz', input_length=19, log_dir='C:\\Users\\30697\\Desktop\\UrbanComputingFinalProject\\UrbanComputingFinalProject\\ST-SSL\\experiments\\NYCBike1\\20240103-115712', lr_init=0.001, max_grad_norm=5, mode='train', nmb_prototype=6, num_nodes=128, percent=0.1, seed=31, shm_temp=0.5, temp=4, test_batch_size=32, use_dwa=True, yita=0.6)
2024-01-03 11:57:13: Traceback (most recent call last):
  File "c:\Users\30697\Desktop\UrbanComputingFinalProject\UrbanComputingFinalProject\ST-SSL\model\aug.py", line 76, in sparsity_correction
    1/0
ZeroDivisionError: division by zero

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:/Users/30697/Desktop/UrbanComputingFinalProject/UrbanComputingFinalProject/ST-SSL/main.py", line 59, in model_supervisor
    results = trainer.train() # best_eval_loss, best_epoch
  File "c:\Users\30697\Desktop\UrbanComputingFinalProject\UrbanComputingFinalProject\ST-SSL\model\trainer.py", line 109, in train
    train_epoch_loss, loss_t = self.train_epoch(epoch, loss_weights)
  File "c:\Users\30697\Desktop\UrbanComputingFinalProject\UrbanComputingFinalProject\ST-SSL\model\trainer.py", line 57, in train_epoch
    repr1, repr2 = self.model(data, self.graph) # nvc
  File "C:\Users\30697\anaconda3\envs\ST-SLL\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "c:\Users\30697\Desktop\UrbanComputingFinalProject\UrbanComputingFinalProject\ST-SSL\model\models.py", line 35, in forward
    graph2 = aug_topology(s_sim_mx, graph, percent=self.args.percent*2)
  File "c:\Users\30697\Desktop\UrbanComputingFinalProject\UrbanComputingFinalProject\ST-SSL\model\aug.py", line 294, in aug_topology
    G = sparsity_correction(G, p - 0.2, sim_mx)
  File "c:\Users\30697\Desktop\UrbanComputingFinalProject\UrbanComputingFinalProject\ST-SSL\model\aug.py", line 78, in sparsity_correction
    raise ValueError(probabilities)
ValueError: [ 2.9996287e-03  2.9996287e-03  2.2268915e-03  2.8290295e-03
  2.9996287e-03  2.2268915e-03  1.1094549e-03  9.6510374e-04
  1.9030684e-03  3.1576888e-05  2.5647262e-04  2.6250891e-03
  2.7630464e-03  2.6987882e-03  1.9877851e-03  2.5080598e-03
  2.6088881e-03  1.9728597e-03  2.5421695e-03  2.9996287e-03
  2.7640979e-05  4.6918826e-04  2.8706996e-03  2.9996287e-03
  2.9996287e-03 -1.0170919e-03  2.2268915e-03  2.9346065e-03
  2.5209694e-03  2.2268915e-03  2.5267450e-03  2.2268915e-03
  1.5346463e-03  2.7611777e-03  1.8529752e-03  2.2201107e-03
  2.7221830e-03  2.7939286e-03  1.8576349e-03  2.5991497e-03
  2.0662041e-03  1.1211003e-03  2.6649660e-03  2.5000626e-03
  1.7239630e-03  1.6829584e-04  2.8109604e-03  2.8706996e-03
  2.4376980e-03  2.9996287e-03  2.9346065e-03  2.9996287e-03
  8.1203959e-04  5.7113665e-04  2.9346065e-03  1.2891782e-03
 -5.4119597e-04  1.0981782e-03  2.6732485e-03  2.6630813e-03
  2.1368975e-03  2.4977939e-03  2.4279205e-03  2.9136380e-03
  2.7235327e-03 -9.7036397e-04  2.6927143e-03  2.7852568e-03
 -6.8603235e-04  2.5432254e-03  1.7681248e-03  1.7412257e-03
  7.9826603e-04  2.4786207e-03  2.4518589e-03  1.7366656e-03
  2.4376980e-03  2.1864923e-03  2.4376980e-03  2.4376980e-03
  2.5338912e-03  2.9996287e-03  2.9996287e-03  8.1203959e-04
  2.9996287e-03  2.9996287e-03  1.9630541e-03  8.1203959e-04
  2.1461586e-03  2.1853477e-03  2.8891196e-03  2.4821796e-03
  2.1866101e-03  2.1000374e-03  2.3234570e-03  2.7673035e-03
  2.8040027e-03  2.7800370e-03  2.6668927e-03  1.7479425e-03
  1.8555069e-03 -1.0796586e-03  1.0209091e-03  2.4870313e-03
  1.0209091e-03  1.0209091e-03  2.9996287e-03  6.5766985e-04
  2.9996287e-03  1.2084373e-03  2.9996287e-03 -6.4424145e-05
 -9.5860579e-04  2.9996287e-03 -1.0484919e-03 -1.1239732e-03
  2.9382259e-03 -9.5860579e-04  2.9669618e-03  2.7690178e-03
  2.9095465e-03  2.9151167e-03  2.7384115e-03  1.0132318e-03
  3.4405637e-04  2.8216955e-03 -7.0131902e-04  2.8593747e-03
  2.8898525e-03  2.8387250e-03  2.6730108e-03 -1.7951718e-04
  2.6974007e-03  2.7700365e-03 -1.7951718e-04  6.5766973e-04
  6.5766973e-04  6.5766973e-04  2.9996287e-03  2.9996287e-03
  2.9996287e-03  2.9996287e-03  2.9996287e-03  2.9996287e-03
 -1.0484919e-03  2.9996287e-03 -1.0523139e-03  2.9571683e-03
 -1.0484919e-03  2.9078680e-03  2.9731132e-03 -8.3045178e-04
  2.8925173e-03  2.8806021e-03  2.9548053e-03  2.6081251e-03
  2.8226862e-03  2.8107951e-03  2.6163196e-03 -9.7346056e-04
  2.8391210e-03  2.8628760e-03 -9.7346056e-04  2.9996287e-03
 -8.2835328e-04  2.9996287e-03  2.9996287e-03  2.6792539e-03
  2.9996287e-03  2.9996287e-03  2.9996287e-03  2.9996287e-03
  2.9996287e-03  2.9996287e-03 -1.0523139e-03  2.9996287e-03
 -6.0925441e-04  2.9996287e-03  2.9126771e-03 -1.0523139e-03
  2.7629572e-03  2.8803123e-03  2.9766245e-03  2.8410261e-03
  2.9219335e-03  2.7199737e-03  2.9339243e-03  2.9027341e-03
  2.0305610e-03 -4.8538781e-04 -8.2835328e-04  2.8011592e-03
  2.6440322e-03 -7.5096230e-04  2.9996287e-03  2.5470872e-04
  2.9996287e-03  2.9996287e-03  2.9996287e-03  2.9996287e-03
  2.9996287e-03  2.9973567e-03  2.9996287e-03  2.9996287e-03
 -6.0925429e-04  2.0401587e-03 -6.4424043e-05  1.3918736e-03
  2.7303773e-03  2.8955599e-03  2.6781494e-03  2.8108808e-03
  2.6025134e-03  2.9148227e-03  2.8155292e-03  2.1535209e-03
  2.7231988e-03  2.9385821e-03  2.4825654e-03  2.4456412e-03
  2.8992656e-03  4.2733463e-04  2.9996287e-03 -2.3618600e-04
  2.9922910e-03  2.9996287e-03  2.7935072e-03  2.9996287e-03
  2.9922910e-03  2.9996287e-03  2.9996287e-03  2.9996287e-03
  2.9996287e-03  2.5754096e-03  1.8987434e-03  7.7649695e-04
  2.7329407e-03  2.7272620e-03  2.5244770e-03  2.5730142e-03
  2.7992527e-03  2.7464975e-03  1.9562589e-03  2.8682190e-03
  1.1564533e-03  2.7171401e-03  2.6642233e-03  2.5455963e-03
  1.1645182e-03 -7.3511430e-05  2.8575598e-03  2.0694993e-03
 -2.3618600e-04  2.3179974e-03  2.9922910e-03  1.9744721e-03
  2.9922910e-03  2.4790412e-03  2.9996287e-03  2.9996287e-03
  2.3961389e-03  2.9996287e-03  2.3961389e-03  2.9996287e-03
  1.5752401e-03  2.7513944e-03  2.2928996e-03  2.3177511e-03
  2.2548900e-03  2.7284606e-03  2.6652652e-03  2.8139937e-03
  2.7749441e-03  2.6201729e-03  2.0365850e-03  2.3143259e-03
  2.8388069e-03  2.5113202e-03  1.3251831e-03  1.8294451e-03
  2.8853368e-03  2.6540214e-03  1.8294451e-03  2.3961389e-03
  2.6792539e-03  2.9996287e-03  1.9630541e-03  2.9423072e-03
  2.9773703e-03  2.3961389e-03  2.8679613e-03  2.5014034e-03
  2.4540448e-03  1.9630541e-03  2.9831612e-03  2.7342774e-03
  2.9175687e-03  2.9138785e-03  2.7622900e-03  2.8270383e-03
  2.7965119e-03  3.6091029e-04  2.7723988e-03  2.3630618e-03
  8.5179007e-04  8.5179007e-04  2.4836147e-03  1.5561206e-03
  1.5561206e-03  1.5561206e-03  2.6792539e-03  2.6792539e-03
  2.6792539e-03  2.7224238e-03  1.9630541e-03  2.9996287e-03
  2.9905457e-03  2.9973567e-03  2.0847386e-03  2.0479199e-03
  2.0326551e-03  1.9630541e-03  2.9879624e-03  2.9831612e-03
  2.9573778e-03  1.7077830e-03 -3.5612460e-04 -3.7160906e-04
  1.7235103e-03 -3.7160906e-04  8.6453150e-04  2.9996287e-03
  2.9996287e-03  2.5754096e-03  1.8601391e-03  2.9996287e-03
  2.5754096e-03  1.8601391e-03  2.9610146e-03  2.9905457e-03
  1.8601391e-03  2.9610146e-03  2.9735765e-03  2.9942617e-03
  2.9750937e-03  2.9905457e-03  2.6336764e-03  2.9973562e-03
  2.9832197e-03  2.9973562e-03  2.9973562e-03  2.9996287e-03
  2.9996287e-03  2.0361044e-03  2.0361044e-03  2.0361044e-03
  2.5754096e-03  2.9996287e-03  2.9996287e-03  2.8730121e-03
  2.8455758e-03  2.2381421e-03  2.1564588e-03  2.3266252e-03
  2.8058384e-03  2.1300993e-03  2.9901967e-03  1.4843835e-03
  2.9876335e-03  2.9735765e-03  2.9922004e-03  2.6186067e-03
  2.9830905e-03  2.9996287e-03  2.4723324e-03  2.9657346e-03
  2.9850216e-03  2.9996287e-03  2.9657346e-03  2.7935072e-03
  2.9996287e-03  2.9996287e-03  2.9996287e-03  2.8730121e-03
  2.9996287e-03  2.9996287e-03  2.8377487e-03  1.7368194e-03
  2.8730121e-03  2.9526087e-03  2.9568493e-03  1.4331907e-03
  1.8025326e-03  2.0533162e-03  2.0745769e-03  2.6188525e-03
  2.8450487e-03  2.8577088e-03  2.8881358e-03  2.6853026e-03
  2.7466260e-03  2.7361542e-03  2.9892530e-03  2.9133363e-03
  2.9933171e-03  2.9794143e-03  2.9779344e-03  2.9936333e-03
  2.9996287e-03  2.9996287e-03  2.9996287e-03  2.8377490e-03
  2.9996291e-03  2.9996291e-03  2.9996291e-03  2.9490555e-03
  2.8377487e-03  2.8377487e-03  2.8377487e-03  2.9141947e-03
  2.7306518e-03  2.7306518e-03  2.9554628e-03  2.9056761e-03
  2.7200449e-03  2.9007096e-03  2.8267219e-03  2.9185691e-03
  2.8990889e-03  2.9428552e-03  2.9613827e-03  2.9825051e-03
  2.9925024e-03  2.9906249e-03  2.9613399e-03  2.9627632e-03
  2.9996287e-03  2.9996287e-03  2.9996287e-03  2.5413404e-03
  2.7049247e-03  2.9941145e-03]

